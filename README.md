**Проект по созданию и ежедневному наполнению двух схем базы данных: staging и mart.**

**dag_migration.py**
- Создает две схемы в базе данных, staging и mart. Сюда же включила добавление поля status и таблицу  customer_retention.
- Заполняет их историческими данными.


**etl_update_user_data_project.py**
- берет файлы инкрементов по вчерашней дате,
- если это дата уже есть в бд - удаляет соответствующие строки,
- заполняет таблицы staging данными за вчерашний день,
- проверяет, что данные за вчерашний день появились,
- обновляет таблицы mart,
NB: catchup=True, чтобы добавить даты между историческим отчетом и вчерашним днем.

**Для запуска дагов** необходимо, чтобы в той же папке находилась папка sql.
Сначала необходимо запустить dag_migration.py, затем etl_update_user_data_project.py


